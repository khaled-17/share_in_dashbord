# هيكل قواعد البيانات في المشروع

يستخدم هذا المشروع نظاماً هجيناً لتخزين البيانات، موزعاً بين خدمات سحابية متعددة وملفات محلية. فيما يلي تحليل شامل لقواعد البيانات المستخدمة.

## 1. قاعدة بيانات العمليات الرئيسية (Main Operations Database)
**النوع:** Supabase (PostgreSQL)
**أداة الاتصال:** `supabase-js` Client
**الوصف:** هذه هي قاعدة البيانات الأساسية التي تدير العمليات اليومية للنظام من إيرادات ومصروفات وعملاء.

### الجداول (Tables):
- **customers**: بيانات العملاء (الاسم، التفاصيل).
- **suppliers**: بيانات الموردين.
- **revenue**: حركات الإيرادات والمقبوضات.
- **expenses**: حركات المصروفات والمدفوعات.
- **expense_types**: تعريف أنواع وتصنيفات المصروفات (مثل: وقود، رواتب).
- **revenue_types**: تعريف أنواع وتصنيفات الإيرادات (مثل: مبيعات، خدمات).
- **users**: (مفترض) لإدارة المستخدمين والمصادقة.

---

## 2. قاعدة بيانات أراء العملاء (Customer Reviews Database)
**النوع:** Supabase (PostgreSQL) - *instance منفصل*
**أداة الاتصال:** Prisma ORM
**الوصف:** قاعدة بيانات مخصصة حديثاً لتخزين أراء وتقييمات العملاء، مفصولة عن قاعدة البيانات التشغيلية لمرونة أكبر.

### الجداول (Tables):
- **CustomerReview**: جدول تخزين المراجعات.
    - `id`: المعرف الفريد.
    - `name`: اسم العميل.
    - `role`: وظيفة العميل.
    - `review`: نص الرأي.
    - `rating`: التقييم (من 5).
    - `avatar`: رابط صورة العميل.
    - `phoneNumber`: رقم هاتف العميل.
    - `createdAt`: تاريخ الإنشاء.

---

## 3. قاعدة بيانات الملفات المحلية (Local File Database)
**النوع:** JSON File
**المسار:** `src/data/expense_types.json`
**الوصف:** يُستخدم كمخزن بيانات بسيط وسريع لبعض أنواع البيانات الثابتة أو النسخ الاحتياطية لأنواع المصروفات، ويتم التعامل معه عبر `fs` في الخادم (`server.js`).

---

## ملخص الاتصالات
| قاعدة البيانات | التقنية | الاستخدام |
|----------------|---------|-----------|
| **Operations** | Supabase Client | إدارة العملاء، الموردين، المالية (إيرادات/مصروفات) |
| **Reviews** | Prisma + Supabase | نظام التقييمات والأراء الجديد |
| **Local JSON** | Node.js FS | تخزين إضافي لأنواع المصروفات (Legacy/Backup) |
